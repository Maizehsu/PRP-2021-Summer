# PRP 论文草稿



## 摘要



## 绪论

### 1. 国内外概况

1. 当前中国/各国交通拥堵现象的趋势；
2. 交通拥堵技术的发展进程，*引入深度学习*；
3. 深度学习概述、对比特点；深度学习技术运用与交通拥堵预测领域的契机、原理、优势（强调是*short-term*）；
4. 主流的深度学习技术，引入*CNN*和*LSTM*

### 2. 选题意义

1. 对于交通拥堵预测技术的需求；

### 3. 目的和研究范围

1. 探索CNN对于具有**周期性**的数据的预测能力
2. CNN和LSTM两大主流算法在**大范围交通拥堵预测**场景下的性能对比
3. 讨论CNN在短期、大规模交通预测中的应用价值

### 4. 解决的主要问题

1. 对于拥堵预测问题的定义
2. 数据获取、预处理和特征提取
3. 将时间序列数据转化为可用于CNN、RNN输入的数据
4. 合理搭建CNN模型
5. 评价算法的性能，与RNN进行对比



## 研究内容及方法

- 定义问题和重要的参数
  - 拥堵指数的定义和计算
  - 问题的定义
- 数据处理
  - 数据来源，样式
  - 数据预处理
  - 数据特征提取
- 神经网络的构建
  - 概述 Overview
  - 确定整个神经网络的结构，卷积层内部结构，池化层结构，损失函数
  - 训练集、测试集的选择，输入输出分别是什么
  - 不同输入间的纵向性能评估标准
  - 图表展示



## 研究结果及讨论

固定变量：输入张量的结构、CNN结构、时间颗粒度为600s，空间颗粒度为140m，轮数50

- 超参数

  - 学习率

    | 学习率 |        MAE         |        MSE         |        RMSE        |
    | ------ | :----------------: | :----------------: | :----------------: |
    | 0.0001 | 0.5972055196762085 | 1.239474892616272  | 1.1133170127868652 |
    | 0.0002 | 0.532464325428009  | 0.8393394351005554 | 0.916154682636261  |
    | 0.0003 | 0.5912213325500488 | 1.2541471719741821 | 1.119887113571167  |
    | 0.0004 | 0.5269864797592163 | 0.7940931916236877 | 0.8911190629005432 |
    | 0.0005 | 0.5918710827827454 | 1.1315741539001465 | 1.0637547969818115 |

    

  - epoch       学习率设置为0.0003

    | epoch | MAE                | MSE                | RMSE               |
    | ----- | ------------------ | ------------------ | ------------------ |
    | 30    | 0.5862030386924744 | 1.1522403955459595 | 1.0734245777130127 |
    | 40    | 0.5947463512420654 | 1.1347113847732544 | 1.0652283430099487 |
    | 50    | 0.6398804187774658 | 1.4738479852676392 | 1.2140214443206787 |

  - 时间颗粒度

    | time_density | MAE                | MSE                | RMSE               |
    | ------------ | ------------------ | ------------------ | ------------------ |
    | 1            | 1.082892894744873  | 3.851741313934326  | 1.9625853300094604 |
    | 2            | 0.8155473470687866 | 2.1642487049102783 | 1.471138596534729  |
    | 3            | 0.937615156173706  | 2.0137438774108887 | 1.4190644025802612 |
    | 6            | 0.5438961982727051 | 0.8396344780921936 | 0.9163157343864441 |

    

  - batch_size

    | batch_size | MAE                | MSE                | RMSE               |
    | ---------- | ------------------ | ------------------ | ------------------ |
    | 32         | 0.6564961075782776 | 1.3210335969924927 | 1.1493622064590454 |
    | 64         | 0.5691036581993103 | 1.004357099533081  | 1.0021761655807495 |
    | 96         | 0.5769609212875366 | 1.039058804512024  | 1.019342303276062  |
    | 128        | 0.6106283664703369 | 1.0573557615280151 | 1.028278112411499  |
    
    

- 输入张量的结构 batch_size=64, epochs=50, learningRate=4e-4，时间颗粒度3

  | Tensor Structure | MAE                | MSE                | RMSE               |
  | ---------------- | ------------------ | ------------------ | ------------------ |
  | 3days + 3hours   | 0.5551854968070984 | 0.9816259145736694 | 0.9907703399658203 |
  | 2days + 2hours   | 0.5438961982727051 | 0.8396344780921936 | 0.9163157343864441 |
  | 3days + 2hours   | 0.6520788073539734 | 1.3597089052200317 | 1.1660655736923218 |
  | 2days + 1hours   | 0.5631470084190369 | 1.0033756494522095 | 1.001686453819275  |
  | 1days + 1hours   | 0.570906400680542  | 1.0146631002426147 | 1.0073049068450928 |
  | 2days            | 0.5809822678565979 | 0.9349933862686157 | 0.966950535774231  |
  | 2hours           | 0.6344599723815918 | 1.4350571632385254 | 1.1979386806488037 |
  | 1day             | 0.5727506875991821 | 0.9215355515480042 | 0.9599664211273193 |
  | 1hour            | 0.6643527150154114 | 1.4061884880065918 | 1.1858282089233398 |

- 不同的时间段



## 结论



### 不足

- 数据来源单一
- 有地域局限性，通用性不强
- 是网格化处理，考虑不到不同交通道路的限速情况



## 参考文献



- 分层：深度学习、交通拥堵
- 交通拥堵按时间间隔可分为短周期预测和长周期预测，我们做的是短期预测
- 拥堵预测可行的现实基础：马路传感器，企业网约车的开源信息
- 实际预测到的参数
- 交通拥堵预测的大致流程
- 数据来源 data source
- 当前的拥堵等级的计算标准会使得一个网格内的拥堵等级随时间*突变*
- 怎么区分*拥堵*和*无运动车辆* -> 必须用拥堵等级作为输入
- 我们用到的Loss Function是什么、
